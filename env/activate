# This script activates environment for the project.
# It should only be used as
# $ source bin/activate
# from the root directory.

# Export local environment
export REPO_NAME="agora-gizmo"
export REPO_DIR="$PWD"
export LOCAL_PREFIX="$REPO_DIR/.local"
export LOCAL_CONDA_PREFIX="$LOCAL_PREFIX/conda-env"
export LOCAL_SYS_FILE="$LOCAL_PREFIX/local-sys"

# Alter system environment
export PATH="$REPO_DIR/env/bin:$PATH"
mkdir -p "$LOCAL_PREFIX/bin"
export PATH="$LOCAL_PREFIX/bin:$PATH"
export PATH="$REPO_DIR/code/bin:$PATH"

# Activate conda env
if [ -d "$LOCAL_CONDA_PREFIX/conda-meta" ]; then
    source enable-conda
    conda activate "$LOCAL_CONDA_PREFIX"
    export PATH="$LOCAL_CONDA_PREFIX/bin:$PATH"
fi

# Activate local env
if [ -f "$LOCAL_SYS_FILE" ]; then
    export LOCAL_SYS="$(cat "$LOCAL_SYS_FILE")"
    source "env/sys/$LOCAL_SYS/activate"
fi
